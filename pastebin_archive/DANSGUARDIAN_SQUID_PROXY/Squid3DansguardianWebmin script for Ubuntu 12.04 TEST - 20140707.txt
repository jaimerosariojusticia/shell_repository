#!/bin/bash
#
# Proxy/Content Filter install script
# by Jaime Rosario Justicia
# July 7, 2014
#=============================================================================#
#
echo -e "Exporting environment settings"
div_echo1=$(echo -e "#$(printf '%.s=' {1..79})#\n")
div_echo2=$(echo -e "#$(printf '%.s-' {1..79})#\n")
#WAN_INET=$(netstat -r | grep "default" | awk '{print $8}')
#-----------------------------------------------------------------------------#
#	Webmin configuration data
#-----------------------------------------------------------------------------#
bind_webmin=/etc/webmin/bind8/config
dg_webmin=/etc/webmin/dansguardian/config
dhcp3_webmin=/etc/webmin/dhcpd/config
dhcp_conf=/etc/dhcp3/dhcpd.conf
dhcpd_pid=/var/run/dhcp3-server/dhcpd.pid
smb_webmin=/etc/webmin/samba/config
squid_webmin=/etc/webmin/squid/config
syslog_webmin=/etc/webmin/syslog/config
wget_dgwbm="http://voxel.dl.sourceforge.net/project/dgwebminmodule/dgwebmin-stable/0.7/dgwebmin-0.7.1.wbm"
wget_nettools="http://www.niemueller.de/webmin/modules/nettools/nettools-1.060.1.wbm.gz"
wget_webmin="http://prdownloads.sourceforge.net/webadmin/webmin_1.540_all.deb"
#-----------------------------------------------------------------------------#
#	Squid3 configuration files
#-----------------------------------------------------------------------------#
squidconf="/etc/squid3/squid.conf"
#squiddir="/etc/squid3"
#squidspool="/var/spool/squid3"
squidacls="/etc/squid3/acls"
#squid_lib="/usr/lib/squid3"
#-----------------------------------------------------------------------------#
#	Dansguardian configuration files
#-----------------------------------------------------------------------------#
dgconf=/etc/dansguardian/dansguardian.conf
dgf1=/etc/dansguardian/dansguardianf1.conf
dgf2=/etc/dansguardian/dansguardianf2.conf
dgf3=/etc/dansguardian/dansguardianf3.conf
dgf4=/etc/dansguardian/dansguardianf4.conf
dgf5=/etc/dansguardian/dansguardianf5.conf
dgf6=/etc/dansguardian/dansguardianf6.conf
bannedurllist=/etc/dansguardian/lists/bannedurllist
exceptionurllist=/etc/dansguardian/lists/exceptionurllist
greyurllist=/etc/dansguardian/lists/greyurllist
bannedsitelist=/etc/dansguardian/lists/bannedsitelist
exceptionsitelist=/etc/dansguardian/lists/exceptionsitelist
greysitelist=/etc/dansguardian/lists/greysitelist
weightedphraselist=/etc/dansguardian/lists/weightedphraselist
blacklists_domains=/tmp/site-lists
blacklists_urls=/tmp/url-lists
#ipgroups=/etc/dansguardian/lists/authplugins/ipgroups
blacklists_dir=/etc/dansguardian/lists/blacklists
bannedphraselist=/etc/dansguardian/lists/bannedphraselist
bannedregexpurllist=/etc/dansguardian/lists/bannedregexpurllist
exceptionregexpurllist=/etc/dansguardian/lists/exceptionregexpurllist
exceptionphraselist=/etc/dansguardian/lists/exceptionphraselist
urlregexplist=/etc/dansguardian/lists/urlregexplist
bannedmimetypelist=/etc/dansguardian/lists/bannedmimetypelist
exceptionmimetypelist=/etc/dansguardian/lists/exceptionmimetypelist
bannedextensionlist=/etc/dansguardian/lists/bannedextensionlist
dansguardianlist=/etc/dansguardian/lists
#exceptionfilesitelist=/etc/dansguardian/lists/exceptionfilesitelist
defaultexceptionsitelist=/etc/dansguardian/lists/defaultexceptionsitelist
defaultexceptionurllist=/etc/dansguardian/lists/defaultexceptionurllist
BL_URL="http://urlblacklist.com/cgi-bin/commercialdownload.pl?type=download&file=bigblacklist"
#-----------------------------------------------------------------------------#
#	network adapters configuration
#-----------------------------------------------------------------------------#
#eth_ALL=$(ifconfig | grep eth | awk '{print $1}')
ALL_NET=$(awk '{print $1}' /proc/net/dev | grep ":" | cut -d ":" -f1 | egrep -v "lo|tun")

#if [[ -z "$WAN_INET" ]]
#then
#	# WAN_INET  Configuration
#	WAN_IP=$(ifconfig "$WAN_INET"  | grep "inet " | cut -d ':' -f2 | awk '{print $1}')
#	WAN_NET=$(ifconfig "$WAN_INET"  | grep "inet " | cut -d '.' -f1,2,3 | cut -d ':' -f2 | awk '{print $0".0"}')
#	WAN_MASK=$(ifconfig "$WAN_INET"  | grep Mask | cut -d ':' -f4 | awk '{print $1}')
#	WAN_BCAST=$(ifconfig "$WAN_INET"  | grep Bcast | cut -d ":" -f3 | cut -d " " -f1)
#	WAN_NETMASK=$(echo -e "$WAN_NET/$WAN_MASK")
#	WAN_CIDR=$(ipcalc "$WAN_NETMASK" | grep Network | cut -d " " -f4)
#else
#	echo -e "Primary network adapter has not been found. Check your networking settings."
#fi
	# $NET1 Configuration
if [[ "$ALL_NET" =~ $NET1 ]]
then
	NET1_IP=$(ifconfig "$NET1" | grep "inet " | cut -d ':' -f2 | awk '{print $1}')
	NET1_NET=$(ifconfig "$NET1" | grep "inet " | cut -d '.' -f1,2,3 | cut -d ':' -f2 | awk '{print $0".0"}')
	NET1_MASK=$(ifconfig "$NET1" | grep Mask | cut -d ':' -f4 | awk '{print $1}')
	NET1_BCAST=$(ifconfig "$NET1" | grep Bcast | cut -d ":" -f3 | cut -d " " -f1)
	NET1_NETMASK=$(echo -e "$NET1_NET/$NET1_MASK")
	NET1_HOSTMIN=$(ipcalc "$NET1_NETMASK" | grep HostMin | cut -d " " -f4 | cut -d "." -f1,2,3 | awk '{print $0".50"}')
	NET1_HOSTMAX=$(ipcalc "$NET1_NETMASK" | grep HostMax | cut -d " " -f4)
	NET1_CIDR=$(ipcalc "$NET1_NETMASK" | grep Network | cut -d " " -f4)
else
 	echo -e "ETH1 network adapter or configuration not found. Check your networking settings."
fi
# $NET2Configuration
if [[ "$ALL_NET" =~ $NET2 ]]
then
	NET2_IP=$(ifconfig "$NET2" | grep "inet " | cut -d ':' -f2 | awk '{print $1}')
	NET2_NET=$(ifconfig "$NET2" | grep "inet " | cut -d '.' -f1,2,3 | cut -d ':' -f2 | awk '{print $0".0"}')
	NET2_MASK=$(ifconfig "$NET2" | grep Mask | cut -d ':' -f4 | awk '{print $1}')
	NET2_BCAST=$(ifconfig "$NET2" | grep Bcast | cut -d ":" -f3 | cut -d " " -f1)
	NET2_NETMASK=$(echo -e "$NET2_NET/$NET2_MASK")
	NET2_HOSTMIN=$(ipcalc "$NET2_NETMASK" | grep HostMin | cut -d " " -f4 | cut -d "." -f1,2,3 | awk '{print $0".50"}')
	NET2_HOSTMAX=$(ipcalc "$NET2_NETMASK" | grep HostMax | cut -d " " -f4)
	NET2_CIDR=$(ipcalc "$NET2_NETMASK" | grep Network | cut -d " " -f4)
else
 	echo -e "ETH2 network adapter not found."
fi
# "$NET3" Configuration
if [[ "$ALL_NET" =~ $NET3 ]]
then
	NET3_IP=$(ifconfig "$NET3" | grep "inet " | cut -d ':' -f2 | awk '{print $1}')
	NET3_NET=$(ifconfig "$NET3" | grep "inet " | cut -d '.' -f1,2,3 | cut -d ':' -f2 | awk '{print $0".0"}')
	NET3_MASK=$(ifconfig "$NET3" | grep Mask | cut -d ':' -f4 | awk '{print $1}')
	NET3_BCAST=$(ifconfig "$NET3" | grep Bcast | cut -d ":" -f3 | cut -d " " -f1)
	NET3_NETMASK=$(echo -e "$NET3_NET/$NET3_MASK")
	NET3_HOSTMIN=$(ipcalc "$NET3_NETMASK" | grep HostMin | cut -d " " -f4 | cut -d "." -f1,2,3 | awk '{print $0".50"}')
	NET3_HOSTMAX=$(ipcalc "$NET3_NETMASK" | grep HostMax | cut -d " " -f4)
	NET3_CIDR=$(ipcalc "$NET3_NETMASK" | grep Network | cut -d " " -f4)
else
 	echo -e "ETH3 network adapter not found."
fi
# "$NET4" Configuration
if [[ "$ALL_NET" =~ $NET4 ]]
then
	NET4_IP=$(ifconfig "$NET4" | grep "inet " | cut -d ':' -f2 | awk '{print $1}')
	NET4_NET=$(ifconfig "$NET4" | grep "inet " | cut -d '.' -f1,2,3 | cut -d ':' -f2 | awk '{print $0".0"}')
	NET4_MASK=$(ifconfig "$NET4" | grep Mask | cut -d ':' -f4 | awk '{print $1}')
	NET4_BCAST=$(ifconfig "$NET4" | grep Bcast | cut -d ":" -f3 | cut -d " " -f1)
	NET4_NETMASK=$(echo -e "$NET4_NET/$NET4_MASK")
	NET4_HOSTMIN=$(ipcalc "$NET4_NETMASK" | grep HostMin | cut -d " " -f4 | cut -d "." -f1,2,3 | awk '{print $0".50"}')
	NET4_HOSTMAX=$(ipcalc "$NET4_NETMASK" | grep HostMax | cut -d " " -f4)
	NET4_CIDR=$(ipcalc "$NET4_NETMASK" | grep Network | cut -d " " -f4)
else
 	echo -e "ETH4 network adapter not found."
fi
#-----------------------------------------------------------------------------#
echo -e "Installing Packages..."
#-----------------------------------------------------------------------------#
apt-get update  &> /dev/null
apt-get -y dselect-upgrade &> /dev/null
apt-get -y autoremove &> /dev/null
apt-get -y install lamp-server^ &> /dev/null
apt-get -y install bridge-utils vlan &> /dev/null
apt-get -y install bind9 dnsutils &> /dev/null
apt-get -y install dhcp3-server &> /dev/null
apt-get -y install ssh openssh-server &> /dev/null
apt-get -y install openssl stunnel &> /dev/null
apt-get -y install ntp ntpdate &> /dev/null
apt-get -y install ^squid3 calamaris &> /dev/null
apt-get -y install dansguardian &> /dev/null
apt-get -y install iptraf minicom traceroute nmap netcat whois ethtool ipcalc curl lynx arp-scan ifstat &> /dev/null
apt-get -y install zlib1g zip unzip &> /dev/null
#-----------------------------------------------------------------------------#
# Uncomment following line to install Samba with Kerberos
#apt-get -y -d install krb5-config krb5-user samba samba-common smbclient smbfs winbind acl likewise-open
#=============================================================================#
#	Webmin and Modules
#-----------------------------------------------------------------------------#
mkdir /tmp/webmin &> /dev/null
echo -e "Downloading and installing Webmin, modules and extras..."
wget -q -c -O /tmp/webmin/webmin.deb $wget_webmin &> /dev/null
wget -q -c -O /tmp/webmin/dgwebmin.wbm $wget_dgwbm &> /dev/null
wget -q -c -O /tmp/webmin/nettools.wbm.gz $wget_nettools &> /dev/null
#
dpkg -i /tmp/webmin/webmin.deb &> /dev/null
apt-get -y -f install &> /dev/null
gzip -d /tmp/webmin/nettools.wbm.gz &> /dev/null
/usr/share/webmin/install-module.pl /tmp/webmin/dgwebmin.wbm &> /dev/null
/usr/share/webmin/install-module.pl /tmp/webmin/nettools.wbm &> /dev/null
#-----------------------------------------------------------------------------#
echo -e "Configuring BIND module..."
sed -i 's|stop_cmd=|stop_cmd=/etc/init.d/bind9 stop|' $bind_webmin
sed -i 's|start_cmd=|start_cmd=/etc/init.d/bind9 start|' $bind_webmin
#
echo -e "Configuring SysLog module..."
sed -i 's|syslogd=/sbin/syslogd|syslogd=/usr/sbin/rsyslogd|' $syslog_webmin
sed -i 's|restart_cmd=/etc/init.d/sysklogd reload|restart_cmd=service rsyslog reload|' $syslog_webmin
sed -i 's|start_cmd=/etc/init.d/sysklogd start|start_cmd=service rsyslog start|' $syslog_webmin
sed -i 's|signal_cmd=/etc/init.d/sysklogd restart|signal_cmd=service rsyslog restart|' $syslog_webmin
sed -i 's|syslog_conf=/etc/syslog.conf|syslog_conf=/etc/rsyslog.conf|' $syslog_webmin
#
echo -e "Configuring Samba Server module..."
if [ -f /etc/samba/smb.conf ]
then
	sed -i 's|stop_cmd|#stop_cmd|' $smb_webmin
	sed -i 's|start_cmd|#start_cmd|' $smb_webmin
	echo -e 'stop_cmd=pkill smbd && pkill nmbd' >> $smb_webmin
	echo -e 'start_cmd=service smbd start && service nmbd start' >> $smb_webmin
fi
#
echo -e "Configuring DHCP Server module..."
sed -i 's|pid_file=/var/run/dhcpd.pid|pid_file='$dhcpd_pid'|' $dhcp3_webmin
#
echo -e "Configuring Dansguardian module..."
> $dg_webmin
{
echo -e "binary_file=/usr/sbin/dansguardian"
echo -e "pid_file=/var/run/dansguardian.pid"
echo -e "start_cmd=/etc/init.d/dansguardian start"
echo -e "stop_cmd=/etc/init.d/dansguardian stop"
echo -e "restart_cmd=/etc/init.d/dansguardian stop && /etc/init.d/dansguardian start"
echo -e "autoreload=1"
echo -e "autorestart=1"
echo -e "restart_type=1"
echo -e "log_path=/var/log/dansguardian"
echo -e "show_fixedlists=0"
echo -e "conf_dir=/etc/dansguardian"
echo -e "log_format=followDansGuardian"
echo -e "messages_path=followDansGuardian" 
} >> $dg_webmin
# Squid module settings
echo -e "Configuring Squid/Squid3 module..."
> $squid_webmin
{
echo -e "sort_conf=0"
echo -e "squidclient=squidclient"
echo -e "cache_dir=/var/spool/squid3"
echo -e "sync_create=0"
echo -e "log_dir=/var/log/squid3"
echo -e "pid_file=/var/run/squid3.pid"
echo -e "cal_max=50000"
echo -e "sync_modify=1"
echo -e "cal_fmt=w"
echo -e "cal_all=1"
echo -e "squid_path=squid3"
echo -e "calamaris=calamaris"
echo -e "squidconf=/etc/squid3/squid.conf"
echo -e "sync_delete=0"
echo -e "cal_args=-aw"
echo -e "cachemgr_path=/usr/lib/cgi-bin/cachemgr3.cgi"
echo -e "crypt_conf=0"
echo -e "restart_pos=0"
echo -e "squid_restart=/etc/init.d/dansguardian stop && squid3 -k reconfigure && /etc/init.d/dansguardian start"
echo -e "squid_start=service squid3 start"
echo -e "cal_extra="
echo -e "squid_stop=/etc/init.d/dansguardian stop && service squid3 stop"
} >> $squid_webmin
#
echo -e "Completed Webmin modules configuration..."
#=============================================================================#
echo -e "Backup Configuration Files..."
#-----------------------------------------------------------------------------#
cp /etc/squid3/squid.conf{,.original}
cp /etc/dhcp3/dhcpd.conf{,.original}
cp /etc/dansguardian/dansguardian.conf{,.original}
cp /etc/dansguardian/dansguardianf1.conf{,.original}
cp /etc/dhcp3/dhcpd.conf{,.original}
cp /etc/resolv.conf{,.original}
#=============================================================================#
echo -e "Configuring BIND DNS Forwarders..."
#-----------------------------------------------------------------------------#
> /etc/resolv.conf
echo -e "nameserver 127.0.0.1" >> /etc/resolv.conf
sed -i '14d' /etc/bind/named.conf.options
sed -i 's|// }|}|' /etc/bind/named.conf.options
sed -i 's|// forwarders|forwarders|' /etc/bind/named.conf.options
#
sed -i '13 a\\t208.67.222.220; # OpenDNS' /etc/bind/named.conf.options
sed -i '13 a\\t208.67.220.222; # OpenDNS' /etc/bind/named.conf.options
#
sed -i '13 a\\t208.67.222.123; # OpenDNS Family Shield' /etc/bind/named.conf.options
sed -i '13 a\\t208.67.220.123; # OpenDNS Family Shield' /etc/bind/named.conf.options
#
/etc/init.d/bind9 restart &> /dev/null
#=============================================================================#
echo -e "Configuring DHCP3 Server settings..."
#-----------------------------------------------------------------------------#
{
echo -e "ddns-update-style none;"
echo -e "default-lease-time 600;"
echo -e "max-lease-time 7200;"
echo -e "log-facility local7;"
echo -e "authoritative;"
echo -e "\t#option domain-name "'"DOMAIN.LOCAL"'";"
} >> $dhcp_conf
#
echo -e "Configuring DHCP Server Subnets..."
#
if [[ "$ALL_NET" =~ $NET1 ]]
then
	{
	echo -e "#Local Network $NET1_NET"
	echo -e "subnet $NET1_NET netmask $NET1_MASK { "
	echo -e "\t#option netbios-node-type 8;"
	echo -e "\t#option netbios-name-servers $NET1_IP;"
	echo -e "\toption time-servers $NET1_IP;"
	echo -e "\toption subnet-mask $NET1_MASK;"
	echo -e "\toption domain-name-servers $NET1_IP;"
	echo -e "\t#option domain-name "'"DOMAIN.LOCAL"'";"
	echo -e "\toption broadcast-address $NET1_BCAST;"
	echo -e "\toption routers $NET1_IP;"
	echo -e "\trange $NET1_HOSTMIN $NET1_HOSTMAX;"
	echo -e "\t} "
	} >> $dhcp_conf
else
	echo ;
fi
if [[ "$ALL_NET" =~ $NET2 ]]
then
	{
	echo -e "#Local Network $NET2_NET"
	echo -e "subnet $NET2_NET netmask $NET2_MASK { "
	echo -e "\t#option netbios-node-type 8;"
	echo -e "\t#option netbios-name-servers $NET2_IP;"
	echo -e "\toption time-servers $NET2_IP;"
	echo -e "\toption subnet-mask $NET2_MASK;"
	echo -e "\toption domain-name-servers $NET2_IP;"
	echo -e "\t#option domain-name "'"DOMAIN.LOCAL"'";"
	echo -e "\toption broadcast-address $NET2_BCAST;"
	echo -e "\toption routers $NET2_IP;"
	echo -e "\trange $NET2_HOSTMIN $NET2_HOSTMAX;"
	echo -e "\t} "
	} >> $dhcp_conf
else
	echo ;
fi
if [[ "$ALL_NET" =~ $NET3 ]]
then
	{
	echo -e "#Local Network $NET3_NET"
	echo -e "subnet $NET3_NET netmask $NET3_MASK { "
	echo -e "\t#option netbios-node-type 8;"
	echo -e "\t#option netbios-name-servers $NET3_IP;"
	echo -e "\toption time-servers $NET3_IP;"
	echo -e "\toption subnet-mask $NET3_MASK;"
	echo -e "\toption domain-name-servers $NET3_IP;"
	echo -e "\t#option domain-name "'"DOMAIN.LOCAL"'";"
	echo -e "\toption broadcast-address $NET3_BCAST;"
	echo -e "\toption routers $NET3_IP;"
	echo -e "\trange $NET3_HOSTMIN $NET3_HOSTMAX;"
	echo -e "\t} "
	} >> $dhcp_conf
else
	echo ;
fi
if [[ "$ALL_NET" =~ $NET4 ]]
then
	{
	echo -e "#Local Network $NET4_NET"
	echo -e "subnet $NET4_NET netmask $NET4_MASK { "
	echo -e "\t#option netbios-node-type 8;"
	echo -e "\t#option netbios-name-servers $NET4_IP;"
	echo -e "\toption time-servers $NET4_IP;"
	echo -e "\toption subnet-mask $NET4_MASK;"
	echo -e "\toption domain-name-servers $NET4_IP;"
	echo -e "\t#option domain-name "'"DOMAIN.LOCAL"'";"
	echo -e "\toption broadcast-address $NET4_BCAST;"
	echo -e "\toption routers $NET4_IP;"
	echo -e "\trange $NET4_HOSTMIN $NET4_HOSTMAX;"
	echo -e "\t} "
	} >> $dhcp_conf
else
	echo ;
fi
#
/etc/init.d/dhcp3-server start &> /dev/null
#=============================================================================#
echo -e "Customizing Squid Proxy server configuration file..."
#-----------------------------------------------------------------------------#
# Creates ACL Folder
mkdir $squidacls &> /dev/null
# Creates extended ACLs and files
touch "$squidacls"/allowed_domains.acl
touch "$squidacls"/allowed_urls.acl
touch "$squidacls"/malware-block-list.acl
touch "$squidacls"/windowsupdate.acl
touch "$squidacls"/wuCONNECT.acl
# Cache and Memory settings
{
echo -e "$div_echo1"
echo -e "#\tWindows Update Fix - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e acl windowsupdate dstdomain '"'"$squidacls"/windowsupdate.acl'"'
echo -e acl wuCONNECT dstdomain '"'"$squidacls"/wuCONNECT.acl'"'
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tJava browser fix - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e acl "Java browser Java/1.4 Java/1.5 Java/1.6"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tAllowed Domains and URLS - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e acl allowed_domains dstdomain '"'"$squidacls"/allowed_domains.acl'"'
echo -e acl allowed_urls dstdom_regex -i '"'"$squidacls"/allowed_urls.acl'"'
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tMalware Block List ACL"
echo -e "$div_echo2"
echo -e "# Uncomment the following lines to enable additional protection for malware."
echo -e "$div_echo2"
echo -e acl malware_block_list url_regex -i '"'"$squidacls"/malware-block-list.acl'"'
echo -e "#deny_info http://localhost/malware-denied.html malware_block_list"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tNTLM / BASIC Proxy Authentication"
echo -e "$div_echo2"
echo -e "# Uncomment the required lines to enable NTLM Authentication with a"
echo -e "# Windows 200x Active Directory Server."
echo -e "$div_echo2"
echo -e "\n"
echo -e "#auth_param ntlm program /usr/bin/ntlm_auth --helper-protocol=squid-2.5-ntlmssp"
echo -e "#auth_param ntlm children 30"
echo -e "#auth_param ntlm keep_alive on"
echo -e "#auth_param ntlm max_challenge_reuses 100"
echo -e "#auth_param ntlm max_challenge_lifetime 10 minutesl."
echo -e "#"
echo -e "#auth_param basic program /usr/bin/ntlm_auth --helper-protocol=squid-2.5-basic"
echo -e "#auth_param basic children 10"
echo -e "#auth_param basic realm DOMAIN"
echo -e "#auth_param basic credentialsttl 2 hour"
echo -e "#auth_param basic casesensitive off"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tBASIC Proxy Authentication"
echo -e "$div_echo2"
echo -e "# Uncomment the required lines to enable Basic Proxy Authentication."
echo -e "$div_echo2"
echo -e "\n"
echo -e "#auth_param basic program /usr/lib/squid3/ncsa_auth /etc/squid3/login"
echo -e "#auth_param basic children 5"
echo -e "#auth_param basic realm Proxy Authentication"
echo -e "#auth_param basic credentialsttl 2 hours"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tAuthentication ACL"
echo -e "$div_echo2"
echo -e "# Uncomment 'acl AUTHENTICATION proxy_auth REQUIRED' to enable"
echo -e "# Proxy Authentication. Remember to uncomment Basic or NTLM Authentication"
echo -e "# settings."
echo -e "$div_echo2"
echo -e "#acl AUTHENTICATION proxy_auth REQUIRED"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tAccess Control List - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e acl manager proto cache_object
echo -e "acl localhost src 127.0.0.1/32"
echo -e "acl to_localhost dst 127.0.0.0/8 0.0.0.0/32"
echo -e acl SSL_ports port 443
echo -e acl Safe_ports port 80
echo -e "acl Safe_ports port 21 # http"
echo -e "acl Safe_ports port 443 # ftp"
echo -e "acl Safe_ports port 70 # https"
echo -e acl CONNECT method CONNECT
echo -e "#"
echo -e "acl localnet src 10.0.0.0/8"
echo -e "acl localnet src 172.16.0.0/12"
echo -e "acl localnet src 192.168.0.0/16"
echo -e "\n"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tProxy Restrictions - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e "\n"
echo -e http_access allow CONNECT wuCONNECT localnet
echo -e http_access allow CONNECT wuCONNECT localhost
echo -e http_access allow windowsupdate localnet
echo -e http_access allow windowsupdate localhost
echo -e "#"
echo -e http_access allow CONNECT Java localnet
echo -e http_access allow CONNECT Java localhost
echo -e http_access allow Java localnet
echo -e http_access allow Java localhost
echo -e "#"
echo -e http_access allow CONNECT allowed_domains localnet
echo -e http_access allow CONNECT allowed_domains localhost
echo -e http_access allow allowed_domains localnet
echo -e http_access allow allowed_domains localhost
echo -e "\n"
echo -e "$div_echo1"
echo -e "# Uncomment the following lines to enable malware protection."
echo -e "$div_echo2"
echo -e "#http_access deny malware_block_list"
echo -e "#http_access deny CONNECT malware_block_list localnet"
echo -e "#http_access deny CONNECT malware_block_list localhost"
echo -e "#http_access deny malware_block_list localnet"
echo -e "#http_access deny malware_block_list localhost"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tSquid3 Default Proxy Manager Settings - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e http_access allow manager localhost
echo -e http_access deny manager
echo -e "http_access deny !Safe_ports"
echo -e "http_access deny CONNECT !SSL_ports"
echo -e "\n"
echo -e "$div_echo1"
echo -e "# Uncomment 'http_access allow AUTHENTICATION' to enable proxy authentication."
echo -e "$div_echo2"
echo -e "#http_access allow AUTHENTICATION"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tSquid3 Default Proxy Settings - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e http_access allow localnet
echo -e http_access allow localhost
echo -e http_access deny all
echo -e icp_access deny all
echo -e htcp_access deny all
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tPort Settings"
echo -e "$div_echo1"
echo -e "# Add '"'transparent'"' after http_port 3128 to enable Transparent Proxy"
echo -e "$div_echo2"
echo -e http_port 3128
echo -e icp_port 3130
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tCache and Memory Settings - BE CAREFUL WHEN CHANGING SETTINGS"
echo -e "$div_echo1"
echo -e "hierarchy_stoplist cgi-bin ?"
echo -e "cache_dir ufs /var/spool/squid3 16384 16 256"
echo -e maximum_object_size 1 GB
echo -e cache_mem 256 MB
echo -e "\n"
echo -e "$div_echo2"
echo -e "# Comment the following settings if slow browsing is experienced."
echo -e "# These are needed uncommented for Windows Update."
echo -e "$div_echo2" 
echo -e "range_offset_limit -1"
echo -e "quick_abort_min -1"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tRefresh Patterns - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e "refresh_pattern ^ftp:\t1440\t20%\t10080"
echo -e "refresh_pattern ^gopher:\t1440\t0%\t1440"
echo -e "refresh_pattern (cgi-bin|\?)\t0\t0%\t0"
echo -e "refresh_pattern .\t\t0\t20%\t4320"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tDNS Name Servers"
echo -e "$div_echo2"
echo -e "# Uncomment only the desired DNS servers."
echo -e "# If you are combining Dansguardian with OpenDNS and need to allow unrestricted"
echo -e "# users or devices to bypass OpenDNS, use the default option."
echo -e "#"
echo -e "# 8.8.8.8, 8.8.4.4 - Google DNS (Not filtered)"
echo -e "# 208.67.222.222, 208.67.220.220 - OpenDNS"
echo -e "# 208.67.222.123, 208.67.220.123 - OpenDNS FamilyShield"
echo -e "$div_echo2"
echo -e "#dns_nameservers 8.8.8.8 8.8.4.4"
echo -e "#dns_nameservers 208.67.222.222 208.67.220.220"
echo -e "#dns_nameservers 208.67.222.123 208.67.220.123"
echo -e "\n"
echo -e "$div_echo1"
echo -e "#\tOther Settings - DO NOT CHANGE"
echo -e "$div_echo1"
echo -e coredump_dir /var/spool/squid3
echo -e visible_hostname localhost
echo -e access_log /var/log/squid3/access.log squid
echo -e error_directory /usr/share/squid3/errors/templates/
echo -e "\n"
} >> "$squidconf"
#-----------------------------------------------------------------------------#
# Adding entries to External ACLs
#-----------------------------------------------------------------------------#
{
echo -e ".adobe.com"
echo -e ".akamai.com"
echo -e ".alwil.com"
echo -e ".antivirus.com"
echo -e ".avast.com"
echo -e ".avg.com"
echo -e ".avira.com"
echo -e ".bancopopular.com"
echo -e ".bitdefender.com"
echo -e ".ca.com"
echo -e ".cloudantivirus.com"
echo -e ".debian.com"
echo -e ".doralbank.com"
echo -e ".edline.net"
echo -e ".edu"
echo -e ".eset.com"
echo -e ".free-av.com"
echo -e ".freeavg.com"
echo -e ".go-mono.com"
echo -e ".gov"
echo -e ".grisoft.com"
echo -e ".grisoft.cz"
echo -e ".java.com"
echo -e ".kaspersky.com"
echo -e ".lavasoft.com"
echo -e ".malwarebytes.org"
echo -e ".mcafeeasap.com"
echo -e ".mcafee.com"
echo -e ".microsoft.com"
echo -e ".mil"
echo -e ".mono-project.com"
echo -e ".mozilla.com"
echo -e ".nai.com"
echo -e ".norman.com"
echo -e ".norton.com"
echo -e ".opera.com"
echo -e ".oracle.com"
echo -e ".pandasecurity.com"
echo -e ".real.com"
echo -e ".safer-networking.org"
echo -e ".sun.com"
echo -e ".superantispyware.com"
echo -e ".symantec.com"
echo -e ".symantecliveupdate.com"
echo -e ".sysinternals.com"
echo -e ".trendmicro.com"
echo -e ".trendsecure.com"
echo -e ".ubuntu.com"
echo -e ".verisign.com"
echo -e ".virusbtn.com"
echo -e ".wikibooks.org"
echo -e ".wikimediafoundation.org"
echo -e ".wikimedia.org"
echo -e ".wikinews.org"
echo -e ".wikipedia.org"
echo -e ".wikiquote.org"
echo -e ".wikisource.org"
echo -e ".wikiversity.org"
echo -e ".wiktionary.org"
echo -e ".windowsupdate.com"
} >> "$squidacls"/allowed_domains.acl
#
{
echo -e "windowsupdate.microsoft.com"
echo -e ".update.microsoft.com"
echo -e "download.windowsupdate.com"
echo -e "redir.metaservices.microsoft.com"
echo -e "images.metaservices.microsoft.com"
echo -e "c.microsoft.com"
echo -e "www.download.windowsupdate.com"
echo -e "wustat.windows.com"
echo -e "crl.microsoft.com"
echo -e "sls.microsoft.com"
echo -e "productactivation.one.microsoft.com"
echo -e "ntservicepack.microsoft.com"
} >> "$squidacls"/windowsupdate.acl
#
echo -e "www.update.microsoft.com" >> "$squidacls"/wuCONNECT.acl
echo -e "sls.microsoft.com" >> "$squidacls"/wuCONNECT.acl
#=============================================================================#
echo	"Dansguardian Multiple Filter Groups Configuration..."
#-----------------------------------------------------------------------------#
#	Backup default Dansguardian configuration files
#-----------------------------------------------------------------------------#
cp $dgconf $dgconf.original
cp $dgf1 $dgf1.original
cp $bannedextensionlist $bannedextensionlist.original
cp $bannedmimetypelist $bannedmimetypelist.original
cp $bannedurllist $bannedurllist.original
cp $exceptionurllist $exceptionurllist.original
cp $greyurllist $greyurllist.original
cp $bannedsitelist $bannedsitelist.original
cp $exceptionsitelist $exceptionsitelist.original
cp $greysitelist $greysitelist.original

# Configuring dansguardian.conf
#-----------------------------------------------------------------------------#
sed -i "s|#authplugin = '/etc/dansguardian/authplugins/ip.conf'|authplugin = '/etc/dansguardian/authplugins/ip.conf'|" $dgconf
sed -i "s|UNCONFIGURED|# UNCONFIGURED|" $dgconf
sed -i "s|filtergroups = 1|filtergroups = 4|" $dgconf
sed -i "s|reverseaddresslookups = off|reverseaddresslookups = on|" $dgconf
sed -i "s|recheckreplacedurls = off|recheckreplacedurls = on|" $dgconf
# Configuring dansguardianf1.conf
#-----------------------------------------------------------------------------#
sed -i "s|enablepics = off|enablepics = on|" $dgf1
sed -i "s|deepurlanalysis = off|deepurlanalysis = on|" $dgf1
sed -i "s|naughtynesslimit = 50|naughtynesslimit = 300|" $dgf1
# Copies Dansguardian Filter Groups configuration files
#-----------------------------------------------------------------------------#
sed -i "s|/lists/|/lists/filter1/|" $dgf1
for s in $(seq 2 6)
 do cp $dgf1 /etc/dansguardian/dansguardianf"$s".conf
done
sed -i "s|filter1|filter2|" $dgf2
sed -i "s|filter1|filter3|" $dgf3
sed -i "s|filter1|filter4|" $dgf4
sed -i "s|filter1|filter5|" $dgf5
sed -i "s|filter1|filter6|" $dgf6
#
# Assing Server IP Address to Template
#-----------------------------------------------------------------------------#
#sed -i "s|localhost|'$WAN_IP'|" /etc/dansguardian/languages/ukenglish/template.html
#
#==============================================================================#
echo	"Setting up Dansguardian IP Filtering group settings..."
#------------------------------------------------------------------------------#
# Change default lists location to contents on each filter directory and group name identification
#-----------------------------------------------------------------------------#
if [[ "$ALL_NET" =~ $NET1 ]]
then
	sed -i "s|#groupname = ''|groupname = 'Network $NET1_CIDR'|" $dgf1
else
	sed -i "s|#groupname = ''|groupname = 'Filter Group 1'|" $dgf1
fi
if [[ "$ALL_NET" =~ $NET2 ]]
then
	sed -i "s|#groupname = ''|groupname = 'Network $NET2_CIDR'|" $dgf2
else
	sed -i "s|#groupname = ''|groupname = 'Filter Group 2'|" $dgf2
fi
if [[ "$ALL_NET" =~ $NET3 ]]
then
	sed -i "s|#groupname = ''|groupname = 'Network $NET3_CIDR'|" $dgf3
else
	sed -i "s|#groupname = ''|groupname = 'Filter Group 3'|" $dgf3
fi
if [[ "$ALL_NET" =~ $NET4 ]]
then
	sed -i "s|#groupname = ''|groupname = 'Network $NET4_CIDR'|" $dgf4
else
	sed -i "s|#groupname = ''|groupname = 'Filter Group 4 - Unrestricted'|" $dgf4
	sed -i "s|groupmode = 1|groupmode = 2|" $dgf4
fi
	sed -i "s|#groupname = ''|groupname = 'Filter Group 5'|" $dgf5
	sed -i "s|#groupname = ''|groupname = 'Filter Group 6'|" $dgf6
#==============================================================================#
echo -e "Customizing Dansguardian Phrase, Regular Expressions and Weighted Filtering settings..."
#------------------------------------------------------------------------------#
# Changing bannedphraselist
#-----------------------------------------------------------------------------#
sed -i 's|rta/banned_portuguese|rta/banned|' $bannedphraselist
sed -i 's|##.Include|#.Include|' $bannedphraselist
sed -i 's|#.Include|.Include|' $bannedphraselist
sed -i 's|#.Include|.Include|' $exceptionphraselist
#-----------------------------------------------------------------------------#
# Changing weightedphraselist
#-----------------------------------------------------------------------------#
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/illegaldrugs|.Include</etc/dansguardian/lists/phraselists/illegaldrugs|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/intolerance|.Include</etc/dansguardian/lists/phraselists/intolerance|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/intolerance/weighted_portuguese>|.Include</etc/dansguardian/lists/phraselists/intolerance/weighted_portuguese>|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/gore|.Include</etc/dansguardian/lists/phraselists/gore|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/gore/weighted_portuguese>|.Include</etc/dansguardian/lists/phraselists/gore/weighted_portuguese>|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/violence|.Include</etc/dansguardian/lists/phraselists/violence|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/weapons|.Include</etc/dansguardian/lists/phraselists/weapons|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/chat|.Include</etc/dansguardian/lists/phraselists/chat|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/personals|.Include</etc/dansguardian/lists/phraselists/personals|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/peer2peer|.Include</etc/dansguardian/lists/phraselists/peer2peer|' $weightedphraselist
sed -i 's|#.Include</etc/dansguardian/lists/phraselists/upstreamfilter|.Include</etc/dansguardian/lists/phraselists/upstreamfilter|' $weightedphraselist
sed -i 's|.Include</etc/dansguardian/lists/phraselists/goodphrases/weighted_general_malay>|#.Include</etc/dansguardian/lists/phraselists/goodphrases/weighted_general_malay>|' $weightedphraselist
sed -i 's|.Include</etc/dansguardian/lists/phraselists/pornography/weighted_japanese>|#.Include</etc/dansguardian/lists/phraselists/pornography/weighted_japanese>|' $weightedphraselist
sed -i 's|.Include</etc/dansguardian/lists/phraselists/pornography/weighted_malay>|#.Include</etc/dansguardian/lists/phraselists/pornography/weighted_malay>|' $weightedphraselist
#-----------------------------------------------------------------------------#
# Changing bannedextensionlist
#-----------------------------------------------------------------------------#
> $bannedextensionlist;
#-----------------------------------------------------------------------------#
# Changing urlregexplist
#-----------------------------------------------------------------------------#
sed -i 's|#"(|"(|' $urlregexplist
#-----------------------------------------------------------------------------#
# Changing bannedregexpurllist
#-----------------------------------------------------------------------------#
sed -i 's|#(naturism|(naturism|' $bannedregexpurllist
sed -i 's|#(^|(^|' $bannedregexpurllist
sed -i 's|#(free|(free|' $bannedregexpurllist
sed -i 's|#(meet|(meet|' $bannedregexpurllist
sed -i 's|#(marr|(marr|' $bannedregexpurllist
{
echo -e "\n"
echo -e "$div_echo2"
echo -e "# Paintball and Gotcha guns"
echo -e "$div_echo2"
echo -e "(paintball|gotcha)"
echo -e "\n"
} >> "$bannedregexpurllist"
#-----------------------------------------------------------------------------#
# Changing exceptionregexpurllist
#-----------------------------------------------------------------------------#
{
echo -e "$div_echo1"
echo -e "#\tException Regular Expresson URL List"
echo -e "$div_echo1"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing ANAL"
echo -e "$div_echo2"
echo -e "(acanalad(a|o)|acanalador|acanaladura|acanalar|acanallad(a|o)|acanallar|aduanal|aguanal|amanal|analectas|anal(e|é)ptic(a|o)|analfabet(a|o)|analfabetismo|analgesia|analg(e|é)sica|analg(e|é)sico|analista|anal(i|í)stica|anal(i|í)stico|anal(i|í)tica|anal(i|í)ticamente|anal(i|í)tico|analitycs|analizable|analizador|analizadora|analizar|analog(i|í)a|anal(o|ó)gic(a|o)|anal(o|ó)gicamente|analyst|analytics|analyze|apanalad(a|o)|arrayanal|artesanal|atarazanal|avellanal|azafranal|bacanal|bacchanal|banal|banalidad|bananal|bisemanal|canal|canalad(a|o)|canalador|canaladura|canaleja|canalera|canalet(a|e|o)|canal(i|í)|canaliega|canaliz(a|o)|canalizable|canalizaci(o|ó)n|canalizar|canalla|canallada|canallesc(a|o)|canal(o|ó)n|caranganal|cientanal|contracanal|cuartanal|encanalar|encanalizar|encanallamiento|encanallar|entrecanal|epanalepsis|fanal|fontanal|google-analytics|granalla|granallar|hermanal|hontanal|humanal|inanalizable|leganal|manal|manzanal|marranalla|mundanal|mundanalidad|panal|pantanal|pichanal|platanal|psicoanalista|psicoanal(i|í)tic(a|o)|psicoanalizar|rabanal|ranal|remanal|sanalotodo|semanal|semanalmente|tarazanal|tempranal|trisemanal|varganal|ventanal)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing ASS"
echo -e "$div_echo2"
echo -e "(admass|admasses|amass|amassed|amasser|amassers|amasses|amassing|amassment|amassments|ambassador|ambassadorial|ambassadors|ambassadorship|ambassadorships|ambassadress|ambassadresses|antiassimilation|antiassimilations|anticlassical|antimacassar|antimacassars|assagai|assagaied|assagaiing|assagais|assai|assail|assailable|assailant|assailants|assailed|assailer|assailers|assailing|assails|assais|assassin|assassinate|assassinated|assassinates|assassinating|assassination|assassinations|assassinator|assassinators|assassins|assault|assaulted|assaulter|assaulters|assaulting|assaultive|assaultively|assaultiveness|assaultivenesses|assaults|assay|assayed|assayer|assayers|assaying|assays|assed|assegai|assegaied|assegaiing|assegais|assemblage|assemblages|assemblagist|assemblagists|assemble|assembled|assembler|assemblers|assembles|assemblies|assembling|assembly|assemblyman|assemblymen|assemblywoman|assemblywomen|assent|assentation|assentations|assented|assenter|assenters|assenting|assentor|assentors|assents|assert|asserted|assertedly|asserter|asserters|asserting|assertion|assertions|assertive|assertively|assertiveness|assertivenesses|assertor|assertors|asserts|assess|assessable|assessed|assesses|assessing|assessment|assessments|assessor|assessors|asset|assets|asseverate|asseverated|asseverates|asseverating|asseveration|asseverations|asseverative|assiduities|assiduity|assiduous|assiduously|assiduousness|assiduousnesses|assign|assignabilities|assignability|assignable|assignat|assignation|assignations|assignats|assigned|assignee|assignees|assigner|assigners|assigning|assignment|assignments|assignor|assignors|assigns|assimilabilities|assimilability|assimilable|assimilate|assimilated|assimilates|assimilating|assimilation|assimilationism|assimilationisms|assimilationist|assimilationists|assimilations|assimilative|assimilator|assimilators|assimilatory|assist|assistance|assistances|assistant|assistants|assistantship|assistantships|assisted|assister|assisters|assisting|assistor|assistors|assists|assize|assizes|asslike|associate|associated|associates|associateship|associateships|associating|association|associational|associationism|associationisms|associationist|associationistic|associationists|associations|associative|associatively|associativities|associativity|assoil|assoiled|assoiling|assoilment|assoilments|assoils|assonance|assonances|assonant|assonantal|assonants|assort|assortative|assortatively|assorted|assorter|assorters|assorting|assortment|assortments|assorts|assuage|assuaged|assuagement|assuagements|assuages|assuaging|assuasive|assumabilities|assumability|assumable|assumably|assume|assumed|assumer|assumers|assumes|assuming|assumpsit|assumpsits|assumption|assumptions|assumptive|assurance|assurances|assure|assured|assuredly|assuredness|assurednesses|assureds|assurer|assurers|assures|assurgent|assuring|assuror|assurors|asswage|asswaged|asswages|asswaging|audiocassette|audiocassettes|avgasses|babassu|babassus|badass|badassed|badasses|bagass|bagasse|bagasses|bass|basses|basset|basseted|basseting|bassets|bassetted|bassetting|bassi|bassinet|bassinets|bassist|bassists|bassly|bassness|bassnesses|basso|bassoon|bassoonist|bassoonists|bassoons|bassos|basswood|basswoods|bassy|biassed|biasses|biassing|bioassay|bioassayed|bioassaying|bioassays|biogasses|biomass|biomasses|bluegrass|bluegrasses|brass|brassage|brassages|brassard|brassards|brassart|brassarts|brassbound|brassed|brasserie|brasseries|brasses|brassica|brassicas|brassie|brassier|brassiere|brassieres|brassies|brassiest|brassily|brassiness|brassinesses|brassing|brassish|brassy|bromegrass|bromegrasses|bunchgrass|bunchgrasses|camass|camasses|canvass|canvassed|canvasser|canvassers|canvasses|canvassing|carassow|carassows|carcass|carcasses|carnassial|carnassials|cassaba|cassabas|cassata|cassatas|cassava|cassavas|casserole|casseroles|casses|cassette|cassettes|cassia|cassias|cassimere|cassimeres|cassino|cassinos|cassis|cassises|cassiterite|cassiterites|cassock|cassocks|cassoulet|cassoulets|cassowaries|cassowary|chasse|chassed|chasseing|chassepot|chassepots|chasses|chasseur|chasseurs|chassis|class|classed|classer|classers|classes|classic|classical|classicalities|classicality|classically|classicism|classicisms|classicist|classicistic|classicists|classicize|classicized|classicizes|classicizing|classico|classics|classier|classiest|classifiable|classification|classifications|classificatory|classified|classifieds|classifier|classifiers|classifies|classify|classifying|classily|classiness|classinesses|classing|classis|classism|classisms|classist|classists|classless|classlessness|classlessnesses|classmate|classmates|classroom|classrooms|classy|coassist|coassisted|coassisting|coassists|coassume|coassumed|coassumes|coassuming|compass|compassable|compassed|compasses|compassing|compassion|compassionate|compassionated|compassionately|compassionateness|compassionatenesses|compassionates|compassionating|compassionless|compassions|contrabass|contrabasses|contrabassist|contrabassists|contrabassoon|contrabassoons|cordgrass|cordgrasses|counterassault|counterassaults|crabgrass|crabgrasses|crass|crasser|crassest|crassitude|crassitudes|crassly|crassness|crassnesses|crevasse|crevassed|crevasses|crevassing|cuirass|cuirassed|cuirasses|cuirassier|cuirassiers|cuirassing|curassow|curassows|cutgrass|cutgrasses|cutlass|cutlasses|dassie|dassies|declass|declasse|declassed|declasses|declassification|declassifications|declassified|declassifies|declassify|declassifying|declassing|degassed|degasser|degassers|degasses|degassing|demitasse|demitasses|detassel|detasseled|detasseling|detasselled|detasselling|detassels|disassemble|disassembled|disassembles|disassemblies|disassembling|disassembly|disassociate|disassociated|disassociates|disassociating|disassociation|disassociations|disembarrass|disembarrassed|disembarrasses|disembarrassing|dispassion|dispassionate|dispassionately|dispassionateness|dispassionatenesses|dispassions|eelgrass|eelgrasses|embarrass|embarrassable|embarrassed|embarrassedly|embarrasses|embarrassing|embarrassingly|embarrassment|embarrassments|embassage|embassages|embassies|embassy|encompass|encompassed|encompasses|encompassing|encompassment|encompassments|eyeglass|eyeglasses|fiberglass|fiberglassed|fiberglasses|fiberglassing|fibreglass|fibreglasses|forepassed|frass|frasses|fricassee|fricasseed|fricasseeing|fricassees|galleass|galleasses|galliass|galliasses|gallowglass|gallowglasses|gassed|gasser|gassers|gasses|gassier|gassiest|gassily|gassiness|gassinesses|gassing|gassings|gassy|glass|glassblower|glassblowers|glassblowing|glassblowings|glassed|glasses|glassful|glassfuls|glasshouse|glasshouses|glassie|glassier|glassies|glassiest|glassily|glassine|glassines|glassiness|glassinesses|glassing|glassless|glassmaker|glassmakers|glassmaking|glassmakings|glassman|glassmen|glasspaper|glasspapered|glasspapering|glasspapers|glassware|glasswares|glasswork|glassworker|glassworkers|glassworks|glasswort|glassworts|glassy|goosegrass|goosegrasses|grass|grassed|grasses|grasshopper|grasshoppers|grassier|grassiest|grassily|grassing|grassland|grasslands|grassless|grasslike|grassroot|grassroots|grassy|groundmass|groundmasses|gyrocompass|gyrocompasses|harass|harassed|harasser|harassers|harasses|harassing|harassment|harassments|hardinggrass|hardinggrasses|hassel|hassels|hassium|hassiums|hassle|hassled|hassles|hassling|hassock|hassocks|hourglass|hourglasses|immunoassay|immunoassayable|immunoassays|impassabilities|impassability|impassable|impassableness|impassablenesses|impassably|impasse|impasses|impassibilities|impassibility|impassible|impassibly|impassion|impassioned|impassioning|impassions|impassive|impassively|impassiveness|impassivenesses|impassivities|impassivity|interassociation|interassociations|interclass|isinglass|isinglasses|jackass|jackasseries|jackassery|jackasses|jassid|jassids|jiveass|johnsongrass|johnsongrasses|kavass|kavasses|knotgrass|knotgrasses|kolbassi|kolbassis|kvass|kvasses|landmass|landmasses|lass|lasses|lassie|lassies|lassitude|lassitudes|lasso|lassoed|lassoer|lassoers|lassoes|lassoing|lassos|lemongrass|lemongrasses|lowerclassman|lowerclassmen|mass|massa|massacre|massacred|massacrer|massacrers|massacres|massacring|massage|massaged|massager|massagers|massages|massaging|massas|massasauga|massasaugas|masscult|masscults|masse|massed|massedly|masses|masseter|masseteric|masseters|masseur|masseurs|masseuse|masseuses|massicot|massicots|massier|massiest|massif|massifs|massing|massive|massively|massiveness|massivenesses|massless|massy|matrass|matrasses|mattrass|mattrasses|megass|megasse|megasses|microcassette|microcassettes|misassay|misassayed|misassaying|misassays|misassemble|misassembled|misassembles|misassembling|misassumption|misassumptions|misbiassed|misbiasses|misbiassing|misclass|misclassed|misclasses|misclassification|misclassifications|misclassified|misclassifies|misclassify|misclassifying|misclassing|molasses|molasseses|morass|morasses|morassy|neoclassic|neoclassical|neoclassicism|neoclassicisms|neoclassicist|neoclassicists|nonassertive|nonassociated|nonclass|nonclasses|nonclassical|nonclassified|nonclassroom|nonclassrooms|nonpasserine|nonpassive|nutgrass|nutgrasses|oquassa|oquassas|outclass|outclassed|outclasses|outclassing|outgassed|outgasses|outgassing|outpass|outpassed|outpasses|outpassing|overassert|overasserted|overasserting|overassertion|overassertions|overassertive|overasserts|overassessment|overassessments|overclassification|overclassified|overclassifies|overclassify|overclassifying|overpass|overpassed|overpasses|overpassing|palliasse|palliasses|pass|passable|passably|passacaglia|passacaglias|passade|passades|passado|passadoes|passados|passage|passaged|passages|passageway|passageways|passagework|passageworks|passaging|passant|passband|passbands|passbook|passbooks|passe|passed|passee|passel|passels|passementerie|passementeries|passenger|passengers|passer|passerby|passerine|passerines|passers|passersby|passes|passible|passim|passing|passings|passion|passional|passionate|passionately|passionateness|passionatenesses|passionflower|passionflowers|passionless|passions|passivate|passivated|passivates|passivating|passivation|passivations|passive|passively|passiveness|passivenesses|passives|passivism|passivisms|passivist|passivists|passivities|passivity|passkey|passkeys|passless|passover|passovers|passport|passports|passus|passuses|password|passwords|peppergrass|peppergrasses|piassaba|piassabas|piassava|piassavas|pingrass|pingrasses|plateglass|postclassic|postclassical|potassic|potassium|potassiums|preassembled|preassign|preassigned|preassigning|preassigns|pseudoclassic|pseudoclassicism|pseudoclassicisms|pseudoclassics|quass|quasses|quassia|quassias|quassin|quassins|radioimmunoassay|radioimmunoassays|rassle|rassled|rassles|rassling|raygrass|raygrasses|reassail|reassailed|reassailing|reassails|reassemblage|reassemblages|reassemble|reassembled|reassembles|reassemblies|reassembling|reassembly|reassert|reasserted|reasserting|reassertion|reassertions|reasserts|reassess|reassessed|reassesses|reassessing|reassessment|reassessments|reassign|reassigned|reassigning|reassignment|reassignments|reassigns|reassort|reassorted|reassorting|reassorts|reassume|reassumed|reassumes|reassuming|reassumption|reassumptions|reassurance|reassurances|reassure|reassured|reassures|reassuring|reassuringly|reclassification|reclassifications|reclassified|reclassifies|reclassify|reclassifying|repass|repassage|repassages|repassed|repasses|repassing|ribgrass|ribgrasses|rubasse|rubasses|ryegrass|ryegrasses|sandglass|sandglasses|sargasso|sargassos|sargassum|sargassums|sass|sassabies|sassaby|sassafras|sassafrases|sassed|sasses|sassier|sassies|sassiest|sassily|sassing|sasswood|sasswoods|sassy|semiclassic|semiclassical|semiclassics|smartass|smartasses|spyglass|spyglasses|strass|strasses|subassemblies|subassembly|subbass|subbasses|subclass|subclassed|subclasses|subclassification|subclassifications|subclassified|subclassifies|subclassify|subclassifying|subclassing|subvassal|subvassals|sunglass|sunglasses|superclass|superclasses|supermassive|surpass|surpassable|surpassed|surpasses|surpassing|surpassingly|switchgrass|switchgrasses|syngasses|tass|tasse|tassel|tasseled|tasseling|tasselled|tasselling|tassels|tasses|tasset|tassets|tassie|tassies|teargassed|teargasses|teargassing|thalassaemia|thalassaemias|thalassemia|thalassemias|thalassemic|thalassemics|thalassic|thalassocracies|thalassocracy|thalassocrat|thalassocrats|thoroughbass|thoroughbasses|trass|trasses|trespass|trespassed|trespasser|trespassers|trespasses|trespassing|unassailabilities|unassailability|unassailable|unassailableness|unassailablenesses|unassailably|unassailed|unassembled|unassertive|unassertively|unassigned|unassimilable|unassimilated|unassisted|unassociated|unassuageable|unassuaged|unassuming|unassumingness|unassumingnesses|unclassical|unclassifiable|unclassified|uncompassionate|underclass|underclasses|underclassman|underclassmen|underpass|underpasses|unembarrassed|unimpassioned|unpassable|unsurpassable|unsurpassed|upperclassman|upperclassmen|vassal|vassalage|vassalages|vassals|vavassor|vavassors|videocassette|videocassettes|vinasse|vinasses|wassail|wassailed|wassailer|wassailers|wassailing|wassails|weatherglass|weatherglasses|windlass|windlassed|windlasses|windlassing|wineglass|wineglasses|wiseass|wiseasses|witchgrass|witchgrasses|wrasse|wrasses|wrassle|wrassled|wrassles|wrassling|zebrass|zebrasses)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing BARE"
echo -e "$div_echo2"
echo -e "(abareque|albarejo|albarelo|albareque|barbareria|barbarer(i|í)a|barbaresca|barbaresco|bareback|barebacked|bareboat|bareboats|bared|barefaced|barefacedly|barefacedness|barefacednesses|barefit|barefoot|barefooted|barege|bareges|barehanded|barehead|bareheaded|barely|barelybareness|baremacion|baremo|bareness|barenesses|bareque|barer|bares|baresark|baresarks|barest|cabaret|cabarets|isobare|isobares|subarea|subareas|tabaret|tabarets|threadbare|threadbareness|threadbarenesses)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing BUTT"
echo -e "$div_echo2"
echo -e "(abuttal|abuttals|abutted|abutter|abutters|abutting|bellybutton|bellybuttons|buttals|butte|butted|butter|butterball|butterballs|buttercup|buttercups|buttered|butterfat|butterfats|butterfingered|butterfingers|butterfish(es)|butterfl(ie(d|s)|y(er(s)|ing))|butterier|butteries|butteriest|buttering|butterless|buttermilk|buttermilks|butternut|butternuts|butters|butterscotch|butterscotches|butterweed|butterweeds|butterwort|butterworts|buttery|buttes|butties|butting|buttinski|buttinskies|buttinsky|button|buttonball|buttonballs|buttonbush|buttonbushes|buttoned|buttoner|buttoners|buttonhole|buttonholed|buttonholer|buttonholers|buttonholes|buttonholing|buttonhook|buttonhooked|buttonhooking|buttonhooks|buttoning|buttonless|buttons|buttonwood|buttonwoods|buttony|buttress|buttressed|buttresses|buttressing|buttstock|buttstocks|keybutton|keybuttons|misbutton|misbuttoned|misbuttoning|misbuttons|rebuttable|rebuttal|rebuttals|rebutted|rebutter|rebutters|rebutting|rebutton|rebuttoned|rebuttoning|rebuttons|scuttlebutt|scuttlebutts|surrebutter|surrebutters|unbuttered|unbutton|unbuttoned|unbuttoning|unbuttons)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing CUM"
echo -e "$div_echo2"
echo -e "(acumen|acuminada|acuminado|acuminosa|acuminoso|acumulable|acumulaci(o|ó)n|acumulador|acumuladora|acumulamiento|acumular|acumulativa|acumulativamente|acumulativo|cacumen|cacuminal|catacumbas|catecumenado|catecumenia|circumcirca|circumincesi(o|ó)n|circumpolar|culcumeque|cuma|cuman(a|o)|cumanagot(a|o)|cuman(e|é)s|cumanesa|cumar(u|ú)|cumba|cumbar(i|í)|cumb(e|é)|cumbearse|cumbia|cumbiamba|cumbo|cumbral|cumbre|cumbrera|cumiche|cum(i|í)nico|cuminol|cumpl|cumpleaños|cumplida|cumplidamente|cumplider(a|o)|cumplido(r(a|es))|cumplimentar|cumplimentera|cumplimentero|cumplimiento|cumplir|cumquibus|cumulaci(o|ó)n|cumulador(a)|cumular|cumulativ(a|o)|cumulativamente|c(u|ú)rcuma|decumbente|descumbrad(a|o)|document|documentaci(o|ó)n|documentad(a|o)|documental|documentalista|documentar|documentaria|documentario|documento|ecum(e|é)nica|ecum(e|é)nico|ecumenismo|encumbrad(a|o)|encumbradamente|encumbramiento|encumbrar|incumbencia|incumbir|incumplida|incumplido|incumplimiento|incumplir|indocumentad(a|o)|l(u|ú)cuma|l(u|ú)cumo|ocume|ocumo|scum(bag)|sucumbir|tucumana|tucumano|vadem(e|é)cum|venim(e|é)cum)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing CUNT"
echo -e "$div_echo2"
echo -e "(acuntir|cuntir)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing CYBER"
echo -e "$div_echo2"
echo -e "(cybercultural|cyberculture|cybernated|cybernation|cybernautic|cybernetic|cybernetical|cybernetically|cybernetician|cyberneticist|cyberneticists|cybernetics)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing DATE"
echo -e "$div_echo2"
echo -e "(acaudate|accommodate|accommodated|accommodates|achordate|airdate|airdates|antedate|antedated|antedates|backdate|backdated|backdates|birthdate|birthdates|candidate|candidates|caudate|caudated|caudates|chordate|chordates|consolidate|consolidated|consolidates|cordate|cordately|cuspidate|cuspidated|date|dateable|datebook|datebooks|dated|datedly|datedness|datednesses|dateless|dateline|datelined|datelines|datelining|dater|daters|dates|denudate|denudated|denudates|depredate|depredated|depredates|dilapidate|dilapidated|dilapidates|ecaudate|elucidate|elucidated|elucidates|emendate|emendated|emendates|exudate|exudates|fecundate|fecundated|fecundates|fluoridate|fluoridated|fluoridates|foredate|foredated|foredates|gradate|gradated|gradates|hemichordate|hemichordates|incudate|intimidate|intimidated|intimidates|inundate|inundated|inundates|invalidate|invalidated|invalidates|iodate|iodated|iodates|lapidate|lapidated|lapidates|liquidate|liquidated|liquidates|mandate|mandated|mandatee|mandates|methylphenidate|methylphenidates|misdate|misdated|misdates|mithridate|mithridates|molybdate|molybdates|noncandidate|noncandidates|nonconsolidated|obcordate|outdate|outdated|outdatedly|outdatedness|outdatednesses|outdates|oxidate|oxidated|oxidates|pedate|pedately|playdate|playdates|postdate|postdated|postdates|predate|predated|predates|reaccommodate|reaccommodated|reaccommodates|reconsolidate|reconsolidated|reconsolidates|redate|redated|redates|reliquidate|reliquidated|reliquidates|retardate|retardates|revalidate|revalidated|revalidates|saltaterandate|sedate|sedated|sedately|sedateness|sedatenesses|sedater|sedates|sedatest|subcordate|subinfeudate|subinfeudated|subinfeudates|transudate|transudates|unaccommodated|unconsolidated|undated|unintimidated|unliquidated|update|updated|updater|updaters|updates|urochordate|urochordates|validate|validated|validates|vanadate|vanadates)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing HARD"
echo -e "$div_echo2"
echo -e "(abuhardillada|abuhardillado|blowhard|blowhards|bohardilla|buharda|buhardilla|caseharden|casehardened|casehardening|casehardens|chard|chards|diehard|diehards|foolhardier|foolhardiest|foolhardily|foolhardiness|foolhardy|hard|harda|hardback|hardbacks|hardball|hardballs|hardboard|hardboiled|hardboots|hardbought|hardbound|hardcase|hardcore|hardcover|hardcovers|harden|hardened|hardener|hardeners|hardening|hardens|harder|hardest|hardhacks|hardhanded|hardhandedness|hardhat|hardhats|hardhead|hardheaded|hardheadedly|hardheadedness|hardheads|hardhearted|hardheartedly|hardheartedness|hardida|hardido|hardier|hardies|hardiest|hardihood|hardily|hardiness|harding|hardinggrass|hardinggrasses|hardly|hardness|hardpan|hardpans|hards|hardset|hardshell|hardship|hardships|hardstand|hardstands|hardtack|hardtacks|hardtop|hardtops|hardware|hardwares|hardwired|hardwood|hardwoods|hardworking|hardy|orchard|orchardist|orchardists|orchardman|orchards|pechardino|pilchard|pilchards|potshard|preharden|prehardened|prehardening|prehardens|reharden|rehardened|rehardening|rehardens|richard|richardson|shard|shards|unhardened)"
echo -e "\n\n"t
echo -e "$div_echo2"
echo -e "# Words containing HOMO"
echo -e "$div_echo2"
echo -e "(eccehomo|homo|homocentric|homocerca|homoclamidea|homoclamideo|homofobia|homofona|homofonia|homofon(i|í)a|homofono|homogenea|homog(e|é)nea|homogeneamente|homog(e|é)neamente|homogeneidad|homogeneity|homogeneizacion|homogeneizar|homogeneo|homog(e|é)neo|homogeneous|homogeneously|homogeneousness|homogenization|homogenize|homogenized|homogenizer|homogenizers|homogenizes|homogenizing|homografa|homografo|homograph|homographic|homographs|homolog|homologa|homologable|homologacion|homologaci(o|ó)n|homologar|homologies|homologo|homologous|homologue|homology|homonima|homonimia|homonimo|homonym|homonymic|homonymies|homonyms|homonymy|homophile|homophiles|homophobe|homophone|homophones|homoplastia|homoplato|homoptero|homosexualidad|homosexualismo|homosexuality|homosexually|homotype|inhomogeneities|nonhomogeneous|orthomolecular|psychomotor|sophomore|sophomores|sophomoric|sophomorically)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing HOOT"
echo -e "$div_echo2"
echo -e "(crapshooters|peashooter|peashooters|sharpshooter|sharpshooters|shooter|shooters|snapshooter|snapshooters|trapshooter|trapshooters|troubleshoot|troubleshooter|troubleshooters|troubleshooting)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing HOOK"
echo -e "$div_echo2"
echo -e "(billhook|billhooks|buttonhook|buttonhooked|buttonhooking|buttonhooks|eyehook|eyehooks|fishhook|fishhooks|hooka|hookah|hookahs|hookas|hooked|hookedness|hookey|hookeys|hookier|hookies|hooking|hookless|hooklets|hooknose|hooknoses|hooks|hookup|hookups|hookworm|hookworms|hooky|pothook|pothooks|shook|shooks|skyhook|skyhooks|tenterhook|tenterhooks|unhook|unhooked|unhooking|unhooks)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing LUST"
echo -e "$div_echo2"
echo -e "(cluster|clustered|clustering|desenlustrar|deslustrador|deslustradora|deslustrar|deslustre|deslustrosa|deslustroso|enlustrecer|filustre|ilustracion|ilustraci(o|ó)n|ilustrada|ilustrado|ilustrador|ilustradora|ilustrar|ilustrativa|ilustrativo|ilustre|ilustremente|ilustres|ilustreza|ilustr(i|í)sima|ilustr(i|í)simo|lustrabotas|lustraci(o|ó)n|lustrador|lustral|lustramiento|lustrar|lustre|lustr(i|í)n|lustrina|lustro|lustrosa|lustrosamente|lustroso|palustre|perilustre)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing MEGA"
echo -e "$div_echo2"
echo -e "(acromegalia|acromegalic|acromegalica|acromegalico|acromegalies|acromegaly|alarmega|al(a|á)rmega|alhamega|alh(a|á)mega|megabar|megabit|megabits|megabuck|megabucks|megabyte|megabytes|megacephalous|megaciclo|megacolon|megacycle|megacycles|megadeath|megadeaths|megadyne|megadynes|megafonia|megafono|megahertz|megakaryocytic|megalith|megalithic|megaliths|megalitica|megal(i|í)tica|megalitico|megal(i|í)tico|megalito|megalomana|megal(o|ó)mana|megaloman(i|í)a|megalomaniac|megalomaniacal|megalomaniacally|megalomaniacs|megalomano|megal(o|ó)mano|megalopolises|megano|megaphone|megaphones|megapod|megarense|megass|megasse|megasses|megaterio|megatons|megavitamin|megavolt|megavolts|megawatt|megawatts|omegas)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing NUDE"
echo -e "$div_echo2"
echo -e "(denude|denuded|denuder|denuders|denudes|desnudez|ennudecer|menudear|menudencia|menudeo|menudera|menudero|nudely|nudeness|nuder|nudest)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing PARTNER"
echo -e "$div_echo2"
echo -e "(copartner|copartners|copartnership|partnered|partnering|partner|partners|partnership|partnerships|subpartnership)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing SEX"
echo -e "$div_echo2"
echo -e "(accessexcellence|asexuada|asexuado|asexual|bisextil|bisexualidad|bisexualismo|closex|decimasexta|decimosexta|decimosexto|heterosexual|heterosexualidad|homosexualidad|homosexualismo|homosexuality|homosexually|intersexual|intersexualidad|litisexpensas|marcasexcluvisas|sexagenaria|sexagenario|sexagesima|sexag(e|é)sima|sexagesimal|sexagesimo|sexag(e|é)simo|sexagonal|sexangula|sex(a|á)ngula|sexangulo|sex(a|á)ngulo|sexcent(e|é)sima|sexcent(e|é)simo|sexenio|sexismo|sexist|sexista|sexma|sexmero|sexmo|sexo_del_bebe|sexologa|sex(o|ó)loga|sexologia|sexolog(i|í)a|sexologo|sex(o|ó)logo|sexta|sextaferia|sextaferiar|sextantaria|sextantario|sextante|sextario|sextavada|sextavado|sextavar|sexteto|sextil|sextilla|sextillo|sextina|sexto|sextuplicaci(o|ó)n|sextuplicar|sexuada|sexuado|sexualidad|sexuality|transexualidad|transexualismo|unisex|unisexual|upsexpress)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing SOFT"
echo -e "$div_echo2"
echo -e "(semisoft|softbacks|softball|softballs|softbound|soften|softened|softener|softeners|softening|softens|softer|softest|softheads|softhearted|softheartedly|softheartedness|softie|softies|softly|softness|softs|software|softwares|softwood|softwoods|softy)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing TINY"
echo -e "$div_echo2"
echo -e "(destiny|mutiny|mutinying|satiny|scrutiny)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing TIT"
echo -e "#----------------------------------------------------------------------------#"
echo -e "(actitar|actitud|actitudes|ahoritita|altitonante|altitud|anticonstitucional|antitanque|antitet(a|á)nica|antitet(a|á)nico|antit(e|é)tica|antit(e|é)tico|antit(o|ó)xica|antit(o|ó)xico|antitoxina|antitrago|antitrinitaria|antitrinitario|antituberculosa|antituberculoso|aortitis|apetite|apetitiva|apetitivo|apetito|apetitosa|apetitoso|aptitud|argentita|bastitana|bastitano|beatitud|bipartita|bipartito|bismutita|botito|calentita|calentito|canastita|cantitativa|cantitativo|cartitem|catita|catite|catitear|ceisatita|certitud|chicorrotita|chicorrotito|chiquirritita|chiquirritito|cistitis|colecistitis|competitiva|competitividad|competitivo|confitito|constit|constituci(o|ó)n|constitucional|constitucionalidad|constitucionalmente|constituidor|constituidora|constituir|constituta|constitutiva|constitutivo|constituto|constituyente|cuantitativa|cuantitativo|cuatripartita|cuatripartito|dacriocistitis|dermatitis|destituci(o|ó)n|destituible|destituidor|destituidora|destituir|destitulada|destitulado|doctitud|empr(e|é)stito|entitativa|entitativo|entity|estalactita|esteatita|estitiquez|estomatitis|etites|exactitud|factitiva|factitivo|fortitud|galactita|galactites|galatites|getit|giobertita|gratitud|hematites|hepatitis|hitita|identity|incertitud|inconstitucional|inconstitucionalidad|ineptitud|inexactitud|ingratitud|institor|instituci(o|ó)n|institucional|institucionalidad|institucionalizaci(o|ó)n|institucionalizar|institucionalmente|institucionista|instituente|instituidor|instituidora|instituir|instituta|instituto|institutor|institutora|institutriz|insubstituible|insustituible|interstit|intitulaci(o|ó)n|intitular|latitante|latitar|latitud|latitude|latitudinal|latitudinaria|latitudinario|latitudinarismo|lentitud|mastitis|multitud|multitudinaria|multitudinario|nictitante|otitis|panclastita|partitiva|partitivo|partitura|patita|patitiesa|patitieso|patituerta|patituerto|pegmatita|periostitis|petitoria|petitorio|potito|prontitud|prostatitis|prostit|prostituci(o|ó)n|prostituir|prostituta|prostituto|queratitis|reconstituci(o|ó)n|reconstituir|reconstituyente|rectitud|restituci(o|ó)n|restituible|restituidor|restituidora|restituir|restitutoria|restitutorio|sostituir|substituci(o|ó)n|substitude|substituible|substituidor|substituidora|substituir|substituta|substitutiva|substitutivo|substituto|subtitular|sup(e|é)rstite|sustituci(o|ó)n|sustituible|sustituidor|sustituidora|sustituir|sustituta|sustitutiva|sustitutivo|sustituto|tita|titan|tit(a|á)n|titanic|tit(a|á)nica|tit(a|á)nico|titanio|titar|titear|titeo|titerera|titerero|titeretada|titerista|tit(i|í)|titiaro|titilaci(o|ó)n|titilador|titiladora|titilar|titileo|tit(i|í)malo|titirimundi|titiritaina|titiritar|titiritera|titiritero|title|tito|titubar|titubear|titubeo|titulaci(o|ó)n|titulada|titulado|titular|titularidad|titularizaci(o|ó)n|titularizar|titulatura|titulillo|titulo|titundia|tituvear|tituveo|tontito|torrotito|tortita|tripartita|tripartito|veintitres|veintitr(e|é)s)"
echo -e "\n\n"
echo -e "$div_echo2"
echo -e "# Words containing TOPP"
echo -e "$div_echo2"
echo -e "(blacktopped|blacktopping|estoppage|estopped|estoppel|estoppels|estopping|overtopped|overtopping|stoppage|stoppages|stopped|stopper|stoppered|stoppering|stoppers|stopping|stopple|stoppled|stopples|stoppling|topped|topper|toppers|topping|toppings|topple|toppled|toppling|unstoppable|unstopped|unstopping)"
echo -e "\n\n"
} >> "$exceptionregexpurllist"

#-----------------------------------------------------------------------------#
# Changing bannedmimetypes and exceptionmimetypes
#-----------------------------------------------------------------------------#
> $bannedmimetypelist;
echo -e "application/x-msn-messenger\t\t# Live Messenger" >> $bannedmimetypelist
echo -e "#application/x-msn-messenger\t\t# Live Messenger" >> $exceptionmimetypelist
echo -e "application/ymsgr\t\t# Yahoo-Messenger" >> $bannedmimetypelist
echo -e "#application/ymsgr\t\t# Yahoo-Messenger" >> $exceptionmimetypelist
echo -e "application/x-bittorrent\t\t# Torrent" >> $bannedmimetypelist
echo -e "#application/x-bittorrent\t\t# Torrent" >> $exceptionmimetypelist
#==============================================================================#
echo	"Customizing Dansguardian filter list with URLBigBlacklist..."
#------------------------------------------------------------------------------#
# Creating temporary site and urls lists
#-----------------------------------------------------------------------------#
touch $blacklists_urls
touch $blacklists_domains
#==============================================================================#
#	Customizing default site access list
#------------------------------------------------------------------------------#
{
echo -e "$div_echo2"
echo -e "#\t\tAllows Government and Education root domains"
echo -e "$div_echo2"
echo -e ".gov"
echo -e "gobierno.pr"
echo -e ".edu"
echo -e ".mil"
echo -e "$div_echo2"
echo -e "#\t\tAllows SSL Autentication for Secure Sites"
echo -e "$div_echo2"
echo -e "verisign.com"
echo -e "$div_echo2"
echo -e "#\t\tAccess for Microsoft systems and applications"
echo -e "$div_echo2"
echo -e "windowsupdate.com"
echo -e "msdnevents.com"
echo -e "microsoft.com"
echo -e "sysinternals.com"
echo -e "$div_echo2"
echo -e "#\t\tApplications for viewing Internet content"
echo -e "$div_echo2"
echo -e "adobe.com"
echo -e "akamai.com"
echo -e "java.com"
echo -e "mozilla.com"
echo -e "opera.com"
echo -e "oracle.com"
echo -e "real.com"
echo -e "sun.com"
echo -e "$div_echo2"
echo -e "#\t\tSystem Security Applications"
echo -e "$div_echo2"
echo -e "alwil.com"
echo -e "antivirus.com"
echo -e "avast.com"
echo -e "avg.com"
echo -e "avira.com"
echo -e "bitdefender.com"
echo -e "ca.com"
echo -e "cloudantivirus.com"
echo -e "eset.com"
echo -e "free-av.com"
echo -e "freeavg.com"
echo -e "grisoft.com"
echo -e "grisoft.cz"
echo -e "kaspersky.com"
echo -e "lavasoft.com"
echo -e "malwarebytes.org"
echo -e "mcafee.com"
echo -e "mcafeeasap.com"
echo -e "nai.com"
echo -e "norman.com"
echo -e "norton.com"
echo -e "pandasecurity.com"
echo -e "pctools.com"
echo -e "safer-networking.org"
echo -e "superantispyware.com"
echo -e "symantec.com"
echo -e "symantecliveupdate.com"
echo -e "sysinternals.com"
echo -e "trendmicro.com"
echo -e "trendsecure.com"
echo -e "virusbtn.com"
echo -e "$div_echo2"
echo -e "#\t\tInternet Banking"
echo -e "$div_echo2"
echo -e "bancopopular.com"
echo -e "bppr.com"
echo -e "doralbank.com"
echo -e "firstbankpr.com"
echo -e "mypopularbanking.com"
echo -e "orientalonline.com"
echo -e "popular.com"
echo -e "santander.com"
echo -e "santandernet.com"
echo -e "santander-ebanking.com"
echo -e "scotiabank.com"
echo -e "scotiabankpr.com"
echo -e "$div_echo2"
echo -e "#\t\tMail and Login"
echo -e "$div_echo2"
echo -e "address.yahoo.com"
echo -e "gmail.google.com"
echo -e "login.live.com"
echo -e "login.yahoo.com"
echo -e "mail.live.com"
echo -e "mail.yahoo.com"
echo -e "screenname.aol.com"
echo -e "$div_echo2"
echo -e "#\t\tWeb Applications"
echo -e "$div_echo2"
echo -e "edline.net\n"
} >> "$defaultexceptionsitelist"
#==============================================================================#
#	Customizing default url access list
#------------------------------------------------------------------------------#
{
echo -e "$div_echo2"
echo -e "\n#\tApplications for viewing Internet content"
echo -e "$div_echo2"
echo -e "google.com/a"
echo -e "google.com/apps"
echo -e "google.com/chrome"
echo -e "apple.com/safari"
echo -e "apple.com/itunes"
echo -e "\n"
} >> "$defaultexceptionurllist"
#-----------------------------------------------------------------------------#
# Merging URLBigBlacklists Expressions
#-----------------------------------------------------------------------------#
{
echo -e "$div_echo1\n#\tURLBigBlacklists Filtered Regular Expressions"
echo -e "$div_echo1"
echo -e ".Include</etc/dansguardian/lists/blacklists/ads/expressions>" 
echo -e ".Include</etc/dansguardian/lists/blacklists/malware/expressions>" 
echo -e ".Include</etc/dansguardian/lists/blacklists/porn/expressions>" 
echo -e "\n"
} >> "$bannedregexpurllist"
#-----------------------------------------------------------------------------#
# Change filter urls blacklists
#-----------------------------------------------------------------------------#
{
echo -e "$div_echo1"
echo -e "# Default Exception URLs List - DO NOT CHANGE"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/defaultexceptionurllist>"
echo -e "$div_echo1"
echo -e "# Add individual urls below this line:"
echo -e "\n\n\n\n"
echo -e "$div_echo1"
echo -e "#"
echo -e "#\tURLBigblacklists Categories"
echo -e "#\tURLS Lists"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tAdult, Offensive Content, Porn, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/adult/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mixed_adult/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/naturism/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/porn/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sexuality/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tAdvertisement, Banners, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/ads/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tAggressive, Hate, Violence, Weapons, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/aggressive/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/guns/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/hunting/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/violence/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/weapons/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tAlcohol, Tobacco, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/alcohol/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/tobacco/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tAnimal Care, Food, Home Improvement, Lifestyle, Traveling, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/gardening/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/homerepair/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/pets/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/vacation/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tArts, Enterntainment, Gossips, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/artnudes/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/astrology/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/celebrity/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/entertainment/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/humor/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/manga/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tBanking, Currency, Financial and Online Payment"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/banking/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/financial/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/personalfinance/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tBlogs and Forums"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/blog/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tBooks, Child Care, Education, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/books/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/child/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/childcare/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/frencheducation/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tComputer Security and System Maintenance"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/antispyware/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/cleaning/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/remote-control/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/updatesites/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tComputer Security Threats"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/desktopsillies/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/dialers/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/hacking/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/malware/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/phishing/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/proxy/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/virusinfected/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tContent Sharing (Audio, Photo, Video)"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/audio-video/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/filehosting/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/filesharing/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tElectronic Commerce, Marketing"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/ecommerce/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/marketingware/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tGoods and Services"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/jobsearch/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tFashion"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/reaffected/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tGambling, Gaming, Time Wasting, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/gambling/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/games/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/kidstimewasting/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/onlinegames/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tGovernment, Military, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/government/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tHealth, Hygiene, Medical, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/abortion/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/contraception/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/medical/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tIllegal Activities"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/drugs/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/warez/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tInformation, Magazines, News, Radio, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/magazines/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/news/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/press/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/radio/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sportnews/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sports/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/weather/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tInternet Mail and Webmail"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mail/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/webmail/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tMobile Phone and Gadgets"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mobile-phone/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tOnline Auctions, Shopping Online, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/onlineauctions/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/shopping/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tReligion and Sect beliefs"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/religion/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sect/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tChat, Dating, Social Networking, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/dating/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/instantmessaging/urls>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/socialnetworking/urls>"
echo -e "#"
echo -e "$div_echo1"
echo -e "#\tWhitelist"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/whitelist/urls>"
echo -e "#"
} >> "$blacklists_urls"
#-----------------------------------------------------------------------------#
cp $blacklists_urls $bannedurllist
cp $blacklists_urls $exceptionurllist
cp $blacklists_urls $greyurllist
#-----------------------------------------------------------------------------#
# Change filter site blacklists
#-----------------------------------------------------------------------------#
{
echo -e "$div_echo1"
echo -e "\n# Default Exception Site List - DO NOT CHANGE"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/defaultexceptionsitelist>"
echo -e "$div_echo1"
echo -e "# Add individual domains below this line:\n$div_echo2\n\n\n\n"
echo -e "$div_echo1"
echo -e "#\tAdult, Offensive Content, Porn, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/adult/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mixed_adult/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/naturism/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/porn/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sexuality/domains>"
echo -e "\n$div_echo1"
echo -e "#\tAdvertisement, Banners, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/ads/domains>"
echo -e "\n$div_echo1"
echo -e "#\tAggressive, Hate, Violence, Weapons, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/aggressive/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/guns/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/hunting/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/violence/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/weapons/domains>"
echo -e "\n$div_echo1"
echo -e "#\tAlcohol, Tobacco, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/alcohol/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/beerliquorinfo/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/beerliquorsale/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/tobacco/domains>"
echo -e "\n$div_echo1"
echo -e "#\tAnimal Care, Food, Home Improvement, Lifestyle, Traveling, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/culinary/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/gardening/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/homerepair/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/pets/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/vacation/domains>"
echo -e "\ndiv_echo1"
echo -e "#\tArts, Enterntainment, Gossips, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/artnudes/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/astrology/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/celebrity/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/entertainment/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/humor/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/manga/domains>"
echo -e "\n$div_echo1"
echo -e "#\tBanking, Currency, Financial and Online Payment"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/banking/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/financial/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/onlinepayment/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/personalfinance/domains>"
echo -e "\n$div_echo1"
echo -e "#\tBlogs and Forums"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/blog/domains>"
echo -e "\n$div_echo1"
echo -e "#\tBooks, Child Care, Education, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/books/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/child/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/childcare/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/frencheducation/domains>"
echo -e "\n$div_echo1"
echo -e "#\tComputer Security and System Maintenance"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/antispyware/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/cleaning/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/remote-control/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/updatesites/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/verisign/domains>"
echo -e "\n$div_echo1"
echo -e "#\tComputer Security Threats"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/desktopsillies/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/dialers/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/hacking/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/malware/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/phishing/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/proxy/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/spyware/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/virusinfected/domains>"
echo -e "\n$div_echo1"
echo -e "#\tContent Sharing (Audio, Photo, Video)"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/audio-video/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/filehosting/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/filesharing/domains>"
echo -e "\n$div_echo1"
echo -e "#\tElectronic Commerce, Marketing"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/ecommerce/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/marketingware/domains>"
echo -e "\n$div_echo1"
echo -e "#\tFashion"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/clothing/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/jewelry/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/reaffected/domains>"
echo -e "\n$div_echo1"
echo -e "#\tGambling, Gaming, Time Wasting, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/gambling/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/games/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/kidstimewasting/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/onlinegames/domains>"
echo -e "\n$div_echo1"
echo -e "#\tGoods and Services."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/jobsearch/domains>"
echo -e "\n$div_echo1"
echo -e "#\tGovernment, Military, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/government/domains>"
echo -e "\ndiv_echo1"
echo -e "#\tHealth, Hygiene, Medical, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/abortion/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/contraception/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/hygiene/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/medical/domains>"
echo -e "\n$div_echo1"
echo -e "#\tIllegal Activities"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/drugs/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/warez/domains>"
echo -e "\n$div_echo1"
echo -e "#\tInternet Search Engines"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/searchengines/domains>"
echo -e "\n$div_echo1"
echo -e "#\tInternet Mail and Webmail"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mail/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/webmail/domains>"
echo -e "\n$div_echo1"
echo -e "#\tMobile Phone and Gadgets"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/cellphones/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/mobile-phone/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/ringtones/domains>"
echo -e "\n$div_echo1"
echo -e "#\tInformation, Magazines, News, Radio, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/magazines/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/news/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/press/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/radio/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sportnews/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sports/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/weather/domains>"
echo -e "\n$div_echo1"
echo -e "#\tOnline Auctions, Shopping Online, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/onlineauctions/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/shopping/domains>"
echo -e "\n$div_echo1"
echo -e "#\tReligion and Sect beliefs"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/religion/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/sect/domains>"
echo -e "\n$div_echo1"
echo -e "#\tChat, Dating, Social Networking, etc."
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/chat/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/dating/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/instantmessaging/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/social_NETworks/domains>"
echo -e "#.Include</etc/dansguardian/lists/blacklists/socialnetworking/domains>"
echo -e "\n$div_echo1"
echo -e "#\tWhitelist"
echo -e "$div_echo2"
echo -e "#.Include</etc/dansguardian/lists/blacklists/whitelist/domains>"
echo -e "\n"
} >> "$blacklists_domains"
#-----------------------------------------------------------------------------#
cp $blacklists_domains $bannedsitelist
cp $blacklists_domains $exceptionsitelist
cp $blacklists_domains $greysitelist
#-----------------------------------------------------------------------------#
sed -i '9 a\\weebo.com' $bannedsitelist
sed -i '9 a\\#twitter.com' $bannedsitelist
sed -i '9 a\\orkut.com' $bannedsitelist
sed -i '9 a\\myspace.com' $bannedsitelist
sed -i '9 a\\myprofile.com' $bannedsitelist
sed -i '9 a\\#facebook.com' $bannedsitelist
sed -i 's|#facebook.com|facebook.com|' $bannedsitelist
sed -i 's|#twitter.com|twitter.com|' $bannedsitelist
#-----------------------------------------------------------------------------#
# Enable list of blocked domains
#-----------------------------------------------------------------------------#
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/ads|.Include</etc/dansguardian/lists/blacklists/ads|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/adult|.Include</etc/dansguardian/lists/blacklists/adult|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/aggressive|.Include</etc/dansguardian/lists/blacklists/aggressive|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/alcohol|.Include</etc/dansguardian/lists/blacklists/alcohol|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/beerliquorinfo|.Include</etc/dansguardian/lists/blacklists/beerliquorinfo|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/beerliquorsale|.Include</etc/dansguardian/lists/blacklists/beerliquorsale|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/chat|.Include</etc/dansguardian/lists/blacklists/chat|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/dating|.Include</etc/dansguardian/lists/blacklists/dating|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/desktopsillies|.Include</etc/dansguardian/lists/blacklists/desktopsillies|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/dialers|.Include</etc/dansguardian/lists/blacklists/dialers|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/drugs|.Include</etc/dansguardian/lists/blacklists/drugs|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/filehosting|.Include</etc/dansguardian/lists/blacklists/filehosting|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/filesharing|.Include</etc/dansguardian/lists/blacklists/filesharing|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/gambling|.Include</etc/dansguardian/lists/blacklists/gambling|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/games|.Include</etc/dansguardian/lists/blacklists/games|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/guns|.Include</etc/dansguardian/lists/blacklists/guns|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/hacking|.Include</etc/dansguardian/lists/blacklists/hacking|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/hunting|.Include</etc/dansguardian/lists/blacklists/hunting|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/instantmessaging|.Include</etc/dansguardian/lists/blacklists/instantmessaging|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/kidstimewasting|.Include</etc/dansguardian/lists/blacklists/kidstimewasting|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/malware|.Include</etc/dansguardian/lists/blacklists/malware|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/manga|.Include</etc/dansguardian/lists/blacklists/manga|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/mixed_adult|.Include</etc/dansguardian/lists/blacklists/mixed_adult|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/naturism|.Include</etc/dansguardian/lists/blacklists/naturism|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/onlinegames|.Include</etc/dansguardian/lists/blacklists/onlinegames|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/phishing|.Include</etc/dansguardian/lists/blacklists/phishing|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/porn|.Include</etc/dansguardian/lists/blacklists/porn|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/proxy|.Include</etc/dansguardian/lists/blacklists/proxy|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/sexuality|.Include</etc/dansguardian/lists/blacklists/sexuality|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/socialnetworking|.Include</etc/dansguardian/lists/blacklists/socialnetworking|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/social_NETworks|.Include</etc/dansguardian/lists/blacklists/social_NETworks|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/spyware|.Include</etc/dansguardian/lists/blacklists/spyware|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/tobacco|.Include</etc/dansguardian/lists/blacklists/tobacco|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/violence|.Include</etc/dansguardian/lists/blacklists/violence|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/virusinfected|.Include</etc/dansguardian/lists/blacklists/virusinfected|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/warez|.Include</etc/dansguardian/lists/blacklists/warez|' $bannedsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/weapons|.Include</etc/dansguardian/lists/blacklists/weapons|' $bannedsitelist
#-----------------------------------------------------------------------------#
# Enable list of allowed domains
#-----------------------------------------------------------------------------#
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/antispyware|.Include</etc/dansguardian/lists/blacklists/antispyware|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/abortion|.Include</etc/dansguardian/lists/blacklists/abortion|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/banking|.Include</etc/dansguardian/lists/blacklists/banking|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/books|.Include</etc/dansguardian/lists/blacklists/books|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/childcare|.Include</etc/dansguardian/lists/blacklists/childcare|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/child|.Include</etc/dansguardian/lists/blacklists/child|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/cleaning|.Include</etc/dansguardian/lists/blacklists/cleaning|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/contraception|.Include</etc/dansguardian/lists/blacklists/contraception|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/culinary|.Include</etc/dansguardian/lists/blacklists/culinary|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/financial|.Include</etc/dansguardian/lists/blacklists/financial|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/gardening|.Include</etc/dansguardian/lists/blacklists/gardening|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/government|.Include</etc/dansguardian/lists/blacklists/government|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/homerepair|.Include</etc/dansguardian/lists/blacklists/homerepair|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/hygiene|.Include</etc/dansguardian/lists/blacklists/hygiene|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/jobsearch|.Include</etc/dansguardian/lists/blacklists/jobsearch|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/magazines|.Include</etc/dansguardian/lists/blacklists/magazines|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/mail|.Include</etc/dansguardian/lists/blacklists/mail|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/medical|.Include</etc/dansguardian/lists/blacklists/medical|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/news|.Include</etc/dansguardian/lists/blacklists/news|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/onlinepayment|.Include</etc/dansguardian/lists/blacklists/onlinepayment|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/personalfinance|.Include</etc/dansguardian/lists/blacklists/personalfinance|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/pets|.Include</etc/dansguardian/lists/blacklists/pets|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/press|.Include</etc/dansguardian/lists/blacklists/press|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/religion|.Include</etc/dansguardian/lists/blacklists/religion|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/remote-control|.Include</etc/dansguardian/lists/blacklists/remote-control|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/sect|.Include</etc/dansguardian/lists/blacklists/sect|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/sportnews|.Include</etc/dansguardian/lists/blacklists/sportnews|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/sports|.Include</etc/dansguardian/lists/blacklists/sports|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/updatesites|.Include</etc/dansguardian/lists/blacklists/updatesites|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/vacation|.Include</etc/dansguardian/lists/blacklists/vacation|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/verisign|.Include</etc/dansguardian/lists/blacklists/verisign|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/weather|.Include</etc/dansguardian/lists/blacklists/weather|' $exceptionsitelist
sed -i 's|#.Include</etc/dansguardian/lists/blacklists/webmail|.Include</etc/dansguardian/lists/blacklists/webmail|' $exceptionsitelist
#-----------------------------------------------------------------------------#
# Creates Filter Groups directories
#-----------------------------------------------------------------------------#
for s in $(seq 1 6)
do
	mkdir $dansguardianlist/filter"$s"
	cp $dansguardianlist/*list $dansguardianlist/filter"$s"
	cp $dansguardianlist/pics $dansguardianlist/filter"$s"
	rm $dansguardianlist/filter"$s"/bannediplist
	rm $dansguardianlist/filter"$s"/exceptioniplist
	rm $dansguardianlist/filter"$s"/filtergroupslist
done
#==============================================================================#
echo	"Installing URLBigBlacklist..."
#------------------------------------------------------------------------------#
cd $dansguardianlist
wget -c -O blacklists.tgz -q -Y on "$BL_URL"
tar xfz blacklists.tgz
find $blacklists_dir -name "domains" -execdir cp {} {}.processed \;
find $blacklists_dir -name "urls" -execdir cp {} {}.processed \;
chown -R root:root $blacklists_dir
#
/etc/init.d/dansguardian stop && /etc/init.d/dansguardian start &> /dev/null
#=============================================================================#
echo	"Rebooting system..."
#-----------------------------------------------------------------------------#
reboot &> /dev/null